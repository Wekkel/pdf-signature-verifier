<Window x:Class="PdfSignatureVerifier.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        mc:Ignorable="d"
        Title="Standalone PDF Signature Verifier" Height="700" Width="1200" WindowStartupLocation="CenterScreen">

    <!-- Hoofdlayout: een Grid met 2 kolommen. -->
    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="400"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Linker kolom: Bediening en Resultaten -->
        <!-- DEZE DOCKPANEL HANDELT NU ALLE DRAG EVENTS AF VOOR DE HELE KOLOM -->
        <DockPanel Grid.Column="0"
                   Margin="0,0,10,0"
                   AllowDrop="True"
                   Background="Transparent"
                   DragEnter="LeftPanelDropTarget_DragEnter"  
            DragOver="LeftPanelDropTarget_DragOver"
                   DragLeave="LeftPanelDropTarget_DragLeave"
                   Drop="LeftPanelDropTarget_Drop">

            <!-- 1. Knop bovenaan om een PDF te selecteren -->
            <Button Name="SelectPdfButton" DockPanel.Dock="Top" Height="60" FontSize="14" FontWeight="Bold" Click="SelectPdfButton_Click">
                <TextBlock Name="SelectPdfButtonText" TextAlignment="Center" TextWrapping="Wrap" Margin="5">
        <Run Name="SelectPdfButtonMainText" FontWeight="Bold" FontSize="14">Selecteer en Analyseer PDF</Run>
        <LineBreak Name="SelectPdfButtonLineBreak"/>
        <Run Name="SelectPdfButtonHint" FontSize="12" FontWeight="Normal">of sleep een PDF bestand hierheen</Run>
                </TextBlock>
            </Button>

            <!-- 2. Statusbalk onderaan voor de Trust List -->
            <StatusBar DockPanel.Dock="Bottom" Background="#F0F0F0" MinHeight="40">
                <!-- Verwijder AllowDrop hier, DockPanel handelt dit af -->
                <StatusBar.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Kopieer volledige log" Click="CopyLog_Click"/>
                    </ContextMenu>
                    </StatusBar.ContextMenu>
                    <StatusBarItem>
                        <TextBlock Name="TrustListStatusText" 
                               Text="EU Trust List: Initialiseren..." 
                               Foreground="Gray"
                               TextWrapping="Wrap">
                            <TextBlock.ToolTip>
                                <ToolTip Content="{Binding Path=Text, RelativeSource={RelativeSource AncestorType=TextBlock}}"/>
                            </TextBlock.ToolTip>
                        </TextBlock>
                    </StatusBarItem>
                    <TextBox Name="LogTextBox" Visibility="Collapsed"/>
            </StatusBar>

            <!-- 3. Resultaatpaneel -->
            <Border Name="ResultPanel" BorderThickness="2" CornerRadius="5" Padding="15" Margin="0,10,0,0" Visibility="Collapsed">
                <!-- Verwijder AllowDrop EN alle Drag event handlers hier, DockPanel handelt dit af -->
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Name="ResultTitle" FontSize="22" FontWeight="Bold" Text="Analyse Resultaat" TextWrapping="Wrap"/>
                        <TextBlock Name="ResultFilename" TextWrapping="Wrap" Margin="0,10,0,0" Foreground="Gray"/>

                        <Border Name="SignatureListPanel" 
                                Visibility="Collapsed" 
                                Margin="0,10,0,10"
                                BorderThickness="1"
                                BorderBrush="LightGray"
                                CornerRadius="3">
                            <StackPanel>
                                <TextBlock Text="Gevonden handtekeningen:" 
                                           FontWeight="Bold" 
                                           Margin="5"/>
                                <ListBox Name="SignatureListBox" 
                                         MaxHeight="150"
                                         SelectionChanged="SignatureListBox_SelectionChanged">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Border Padding="5" Margin="2">
                                                <StackPanel>
                                                    <TextBlock FontWeight="Bold">
                                                        <TextBlock.Text>
                                                            <MultiBinding StringFormat="{}{0}. {1}">
                                                                <Binding Path="Index"/>
                                                                <Binding Path="SignerName"/>
                                                            </MultiBinding>
                                                        </TextBlock.Text>
                                                    </TextBlock>
                                                    <TextBlock Text="{Binding SignDate}" 
                                                               FontSize="11" 
                                                               Foreground="Gray"/>
                                                    <TextBlock Text="{Binding Status}" 
                                                               FontSize="11">
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock">
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Status}" Value="QES">
                                                                        <Setter Property="Foreground" Value="Green"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Status}" Value="AES">
                                                                        <Setter Property="Foreground" Value="DodgerBlue"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Status}" Value="Ongeldig">
                                                                        <Setter Property="Foreground" Value="Red"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </StackPanel>
                        </Border>
                        <Separator Margin="0,15,0,15"/>
                        <TextBlock Name="ResultExplanation" FontSize="14" TextWrapping="Wrap" LineHeight="20"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </DockPanel>

        <!-- Rechter kolom: PDF Viewer -->
        <Border Grid.Column="1" BorderThickness="1" BorderBrush="LightGray">
            <wv2:WebView2 Name="PdfWebView" />
        </Border>

        <!-- DE "LeftPanelDropTarget" IS NU ALLEEN DE ZICHTBARE OVERLAY -->
        <!-- Deze krijgt de ZIndex van 100 en IsHitTestVisible="False" zodat het standaard doorzichtbaar is voor muisclicks -->
        <Border Name="LeftPanelDropTarget"
                Grid.Column="0"
                Background="#AAFFFFFF" 
                BorderBrush="DodgerBlue" 
                BorderThickness="4" 
                CornerRadius="10"
                Panel.ZIndex="100"
                IsHitTestVisible="False"  
            Visibility="Collapsed">
            <TextBlock Text="Laat het PDF-bestand hier los om te analyseren"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       FontSize="24"
                       FontWeight="Bold"
                       Foreground="DodgerBlue"
                       TextWrapping="Wrap"/>
        </Border>

    </Grid>
</Window>